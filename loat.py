# -*- coding: utf-8 -*-
"""LOAT.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1t6PJrmef8ryq230B-In3s9XpmUbJdSme
"""

# Install necessary packages
!pip install torch torchvision
!pip install torch torchvision torchattacks

import torch
import torch.nn as nn
import torch.optim as optim
import torchvision.transforms as transforms
import torchvision.datasets as datasets
from torchvision.models import resnet18
from torch.utils.data import DataLoader
import torchattacks
import torch.nn.functional as F

def pgd_adversarial_samples(model, data, target, epsilon=8/255, alpha=2/255, num_iter=10):
    pgd_attack = torchattacks.PGD(model, eps=epsilon, alpha=alpha, steps=num_iter)
    adv_data = pgd_attack(data, target)
    return adv_data

# Define the overall loss function for adversarial training
def adversarial_objective(model, data, target, lambda_param, epsilon=8/255, alpha=2/255, num_iter=10):
    clean_output = model(data)
    clean_loss = nn.CrossEntropyLoss()(clean_output, target)

    adv_data = pgd_adversarial_samples(model, data, target, epsilon, alpha, num_iter)
    adv_output = model(adv_data)
    adv_loss = nn.CrossEntropyLoss()(adv_output, target)

    total_loss = (1 - lambda_param) * clean_loss + lambda_param * adv_loss
    return total_loss

"""![image.png](data:image/png;base64,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)"""

def term_P_NC(model, data, labels, num_classes):
    output = model(data)
    output_softmax = F.softmax(output, dim=1)

    N = data.size(0)
    K = num_classes

    P_NC = 0
    for i in range(N):
        correct_class = labels[i].item()
        incorrect_classes = [k for k in range(num_classes) if k != correct_class]

        IC = 1 if torch.argmax(output_softmax[i]) == correct_class else 0
        if IC == 1:
            sum_softmax_incorrect = torch.sum(output_softmax[i][incorrect_classes])
            term = (output_softmax[i][incorrect_classes] - (1 / (K - 1)) * sum_softmax_incorrect)**2
            P_NC += torch.sum(term)

    P_NC /= (N * (K - 1))
    return P_NC

"""![image.png](data:image/png;base64,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)"""

# Define the surrogate regularization term P_NM
def term_P_NM(model, data, labels, num_classes):
    output = model(data)
    output_softmax = F.softmax(output, dim=1)

    N = data.size(0)
    K = num_classes

    P_NM = 0
    for i in range(N):
        correct_class = labels[i].item()
        incorrect_classes = [k for k in range(num_classes) if k != correct_class]

        IM = 1 if torch.argmax(output_softmax[i]) != correct_class else 0
        if IM == 1:
            sum_softmax_incorrect = torch.sum(output_softmax[i][incorrect_classes])
            term = ((1 / (K - 1)) * sum_softmax_incorrect - output_softmax[i][incorrect_classes] )**2
            P_NM += torch.sum(term)

    P_NM /= (N * (K - 1))
    return P_NM

# Define the LOAT training algorithm
def loat_training(victim_model, train_loader, adversarial_objective, E1, E2, E_hat, tau, gamma, T, optimizer, num_classes, lambda_value):
    total_batches = len(train_loader)
    for epoch in range(E_hat):
        correct = 0
        total = 0
        for batch_idx, (data, target) in enumerate(train_loader):
            data, target = data.to(device), target.to(device)
            optimizer.zero_grad()

            if epoch <= E1:
                if T == 'SLORE':
                    loss = adversarial_objective(victim_model, data, target, lambda_value) + \
                           tau * (term_P_NC(victim_model, data, target, num_classes) - term_P_NM(victim_model, data, target, num_classes))
                else:
                    loss = adversarial_objective(victim_model, data, target, lambda_value)+ \
                           tau * (term_P_NC(victim_model, data, target, num_classes) - term_P_NM(victim_model, data, target, num_classes))
            elif epoch >= E2:
                if T == 'SLORE':
                    loss = adversarial_objective(victim_model, data, target, lambda_value) + \
                           tau * (term_P_NM(victim_model, data, target, num_classes) - term_P_NC(victim_model, data, target, num_classes))
                else:
                    loss = adversarial_objective(victim_model, data, target, lambda_value) + \
                           tau * (term_P_NM(victim_model, data, target, num_classes) - term_P_NC(victim_model, data, target, num_classes)) + \
                           gamma * adversarial_objective(victim_model, data, target)
            else:
                loss = adversarial_objective(victim_model, data, target, lambda_value)

            loss.backward()
            optimizer.step()

            # Print progress
            progress = (batch_idx + 1) / total_batches * 100
            print(f"\rEpoch [{epoch+1}/{E_hat}] Batch [{batch_idx+1}/{total_batches}] Progress: {progress:.2f}% Loss: {loss.item():.4f}", end='')

            # Calculate accuracy
            _, predicted = torch.max(victim_model(data).data, 1)
            total += target.size(0)
            correct += (predicted == target).sum().item()

        accuracy = 100 * correct / total
        print(f'Epoch {epoch + 1}/{E_hat} completed. Loss: {loss.item():.4f} Accuracy: {accuracy:.2f}%')


    return victim_model

# Hyperparameters
E1 = 1
E2 = 100
E_hat = 110
tau = 0.1
gamma = 0.1
T = 'SLORE'
num_classes = 10
lambda_param = 0.5

# Load the CIFAR-10 dataset
transform = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
])

trainset = datasets.CIFAR10(root='./data', train=True, download=True, transform=transform)

train_loader = DataLoader(trainset, batch_size=64, shuffle=True, num_workers=2)

# Initialize the model, optimizer, and device
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
victim_model = resnet18(pretrained=False, num_classes=num_classes).to(device)
optimizer = optim.Adam(victim_model.parameters(), lr=0.001)

# Train the model using LOAT
trained_model = loat_training(victim_model, train_loader, adversarial_objective, E1, E2, E_hat, tau, gamma, T, optimizer, num_classes, lambda_param)

# Save the trained model
torch.save(trained_model.state_dict(), 'loat_trained_resnet18_cifar10.pth')